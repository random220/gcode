https://ubuntu.com/tutorials/how-to-run-docker-inside-lxd-containers#2-create-lxd-container



need in /etc/resolv.conf
nameserver 10.14.244.53
nameserver 10.14.236.53
search dev.purestorage.com



Make sure volume is btrfs. zfs will suck for this
lxc network set lxdbr0 raw.dnsmasq "dhcp-option-force=option:domain-search,lxd,dev.purestorage.com"

lxc network set lxdbr0 raw.dnsmasq "dhcp-option-force=option:domain-search,lxd,dev.purestorage.com"


lxc network set lxdbr0 raw.dnsmasq dhcp-option=6,8.8.8.8,8.8.4.4 #(6 means the DNS configuration)



lxc network set lxdbr0 raw.dnsmasq "dhcp-option-force=option:domain-search,lxd,dev.purestorage.com
lxc network set lxdbr0 raw.dnsmasq dhcp-option=6,10.14.244.53,10.14.244.53 #(6 means the DNS configuration)


lxc network set lxdbr0 raw.dnsmasq "dhcp-option=option:dns-server,10.14.244.53"
lxc network set lxdbr0 raw.dnsmasq "dhcp-option-force=option:dns-server,10.14.244.53"
lxc network set lxdbr0 raw.dnsmasq "dhcp-option-force=option:dns-server,10.14.236.53"

lxc launch ubuntu:18.04 u18py37dock-00
lxc stop u18py37dock-00
lxc config set u18py37dock-00 \
    security.nesting=true \
    security.syscalls.intercept.mknod=true \
    security.syscalls.intercept.setxattr=true



lxc start u18py37dock-00
lxc exec u18py37dock-00 su -
userdel -r ubuntu
groupdel ubuntu
useradd -s /bin/bash -m ir
passwd ir
welcome
echo 'ir ALL=(ALL:ALL) NOPASSWD: ALL' >/etc/sudoers.d/ir
exit
lxc exec u18py37dock-00 su - ir
sudo apt-get -y update
sudo apt-get -y dist-upgrade

. <(curl -s https://raw.githubusercontent.com/random220/gcode/main/bin/gcode.0)
gcode/bin/docki  # to install docker
sudo usermod -aG docker $LOGNAME


#pyenv python3.7.13
sudo apt-get -y install make build-essential libssl-dev zlib1g-dev\
    libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev\
    libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python-openssl\
    git

git clone https://github.com/pyenv/pyenv.git ~/.pyenv

cat <<'EOF' >>~/.bashrc

export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv 1>/dev/null 2>&1; then
  eval "$(pyenv init -)"
fi
EOF

. ~/.bashrc

pyenv install --list|grep ' 3.7' # list what can be installed
pyenv install 3.7.13
pyenv versions                   # list what are installed

pyenv global 3.7.13              # Activate this even for all subsequent logins
% python --version
Python 3.7.13
% python3 --version
Python 3.7.13


exit


lxc stop u18py37dock-00
lxc snapshot u18py37dock-00

lxc copy u18py37dock-00/snap0 citi
lxc start citi
lxc exec citi su - ir




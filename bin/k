#!/bin/bash
set -x

export PATH="$HOME/bin:$HOME/gcode/bin:/usr/local/bin:/bin:/sbin:/usr/bin:/usr/sbin"

ssh_and_k()
{
  remote='192.168.10.180'
  x=$(ifconfig -a |grep '192\.168\.10\.')
  if [[ $x == '' ]]; then
    remote='crondite.duckdns.org'
  fi
  ssh -t om@$remote 'gcode/bin/k'
}

k()
{
  sudo service lightdm stop
  sleep 3
  sudo service lightdm start
  sleep 3
  screen -dm bash -c 'DISPLAY=:0.0 env >a.txt'
}

x=$(ifconfig -a |grep '192\.168\.10\.180')
if [[ $x == '' ]]; then
  ssh_and_k
else
  k
fi

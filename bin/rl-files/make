#!/bin/bash
docker rm -f rl
docker rmi -f myrl
docker build -t myrl .
h=rl
docker run -d --name $h -h $h \
    -p 3022:22 \
    -p 3128:3128 \
    -p 3129:3129 \
    -v ~/:/home/om/h \
    myrl

if [[ -d ~/gcode ]]; then
    docker cp ~/gcode/ rl:/home/om/gcode/
    docker exec -i rl bash -c 'chown -R om:om /home/om/gcode'
    docker exec -i -u om -w /home/om rl bash -c '. gcode/bin/gcode.0'
    docker exec -i -u om -w /home/om rl bash -c '. .bashrc; gits'
fi
docker exec -it -u om -w /home/om rl bash
